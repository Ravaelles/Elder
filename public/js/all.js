function EngineView(t,i){this.width=-1,this.height=-1,this.constructor=function(t,i){this.width=t,this.height=i},this.constructor(t,i),this.getType=function(){return this.type}}function buildStyleStringForImg(t,i,n,e,o,a){var r="position: relative; ";if(n)t.marginLeft=e.width()/2-o/2,t.marginTop=e.height()/2-a/2,(i._action===SPEAR_EQUIP||i._action===SPEAR_UNEQUIP)&&(t.marginTop-=18,t.marginLeft-=17);else{if(t.marginLeft=-o/2,t.marginTop=-a,i.isActionWalk()){if(i.isActionWithWeapon(WEAPON_SPEAR))var s=.25,m=.3;else var s=.38,m=.32;var d=a/5;i._dir===DIR_E?t.marginLeft+=o*s:i._dir===DIR_W?t.marginLeft+=-o*s:i._dir===DIR_SE?(t.marginLeft+=o*m,t.marginTop+=a*m):i._dir===DIR_SW?(t.marginLeft-=o*m,t.marginTop+=a*m):i._dir===DIR_NW?(t.marginLeft+=-o*m,t.marginTop+=-a*m+d):i._dir===DIR_NE&&(t.marginLeft+=o*m,t.marginTop+=-a*m+d)}(i._action===SPEAR_EQUIP||i._action===SPEAR_UNEQUIP)&&(i._dir===DIR_SE?(t.marginLeft-=14,t.marginTop+=8):i._dir===DIR_SW?t.marginLeft-=18.5:i._dir===DIR_NE?(t.marginLeft+=18,t.marginTop+=3.5):i._dir===DIR_NW?t.marginLeft+=15:i._dir===DIR_E?(t.marginLeft-=5,t.marginTop+=12):i._dir===DIR_W&&(t.marginLeft+=4))}return t.marginLeft+=i.positionPX,t.marginTop+=i.positionPY,t.marginLeft&&(r+="left:"+t.marginLeft+"px; "),t.marginTop&&(r+="top:"+t.marginTop+"px; ",r+="z-index: "+(t.marginTop+a)+"; "),r}function DIR_RANDOM(){return randElem(DIR_ALL)}function DIR_RANDOM_SOUTH(){return randElem([DIR_SW,DIR_SE])}function DIR_RANDOM_NORTH(){return randElem([DIR_NW,DIR_NE])}function Unit(t){this._id=null,this._sex=null,this._action=null,this._dir=null,this._type=null,this.staticImageDisplayMode=!1,this.marginLeft=0,this.marginTop=0,this.positionPX=0,this.positionPY=0,this._lastAnimationEndsAt=0,this._divSelector=null,this.constructor=function(t){var i;i="string"==typeof t?JSON.parse(t):t,this._id=i.id?i.id:__firstFreeUnitId++,this._sex=i.sex?"n"+i.sex.toLowerCase():MALE,this._action=i.action?i.action:ACTION_IDLE,this._dir=i.dir?i.dir:DIR_SE,this._type=i.type,this._type||(console.log("Empty unit type for unit:"),console.log(this),alert("Empty unit type passed for new unit")),allUnits[this._id]=this},this.constructor(t),this.display=function(t){function i(t,i){$("#unit-img-"+t).attr("src",i)}this.staticImageDisplayMode=t;var n=this.createImageElement(),e=n.imageElement,o=n.imagePath;this.staticImageDisplayMode||this.createImageWrapper();var a=new Image;return a.unitId=this._id,a.unit=this,a.imageIsLoaded=!1,a.onload=function(n){var a="<script>$('#unit-img-"+this.unitId+"').css('border', '1px solid rgba(255,0,0,0.2)')</script>";NaN+this.unitId+"').css('border', 'none'); }, 1000)</script>",$("#canvas-debug").html(a);var r=$("#unit-img-"+this.unitId).attr("src");if(i(this.unitId,r),!this.imageIsLoaded){var s=this.unit;this.imageIsLoaded=!0,this.src=o;var m=this.width,d=this.height,l=$("#unit-wrapper-"+this.unitId);l.html(e);var _=$("#unit-img-"+this.unitId);s._imageSelector=_,_.attr({imgwidth:m,imgheight:d}),_.css("z-index",s.positionPY);var c=buildStyleStringForImg(this,s,t,l,m,d);c&&_.attr("style",c)}},a.src=o,this},this._queueAnimations=[],this.queueAnimation=function(t,i,n){var e,o=this.timeSinceLastAnimationEndedAgo(),a=o>=-20;if(n||(n=WALK_ANIMATION_LENGTH),i||(i=0),a?(e=0,this._lastAnimationEndsAt=this.timeNow()+i+n):(e=-o,this._lastAnimationEndsAt+=i+e+n),a&&0===this._queueAnimations.length)this._runAnimationNow(t,i,n);else{var r={options:t,animationLength:n,delay:i};this._queueAnimations.push(r)}return this},this._runAnimationNow=function(t,i,n){var e=this;return setTimeout(function(){var i=t.callbackAnimationAfterStart;i&&i(e,t),e._animate(t),setTimeout(function(){var i=t.callbackAnimationEnded;i&&i(e),e.runNextQueuedAnimationIfNeeded()},n,e)},i),this},this.runNextQueuedAnimationIfNeeded=function(){var t=this._queueAnimations.shift();if(void 0!==t){var i=t.options,n=t.animationLength,e=t.delay;this._runAnimationNow(i,e,n)}},this._animate=function(t,i){i||(i=0),t||(t=[]);var n=t.callbackAnimationBeforeStart;n&&n(this);var e=this;return setTimeout(function(){e.handleOptions(t),e.display(e.staticImageDisplayMode)},i),this._lastAnimationStarted+=i,this},this.timeSinceLastAnimationEndedAgo=function(){return this.timeNow()-this._lastAnimationEndsAt},this.timeNow=function(){return(new Date).getTime()},this.animation=function(t,i,n){return t||(t={}),n||(n=1700),(!i||0>i)&&(i=0),this.queueAnimation(t,i,n),this},this.walk=function(t,i){var n=WALK_ANIMATION_LENGTH+ +(0===this._queueAnimations.length?WALK_ANIMATION_MODIFIER_WHEN_FIRST:0);this.timeSinceLastAnimationEndedAgo();return i||(i=0),t||(t=[]),t.callbackAnimationAfterStart=function(t,i){t.convertActionToWalk()},t.callbackAnimationEnded=function(t){t.handleWalkPositionChange(),0===t._queueAnimations.length&&(t.convertActionToIdle(),t._animate())},this.queueAnimation(t,i,n),this},this.convertActionToWalk=function(){return this._action=this._action.replaceAt(1,"b"),this},this.convertActionToIdle=function(){return this._action=this._action.replaceAt(1,"a"),this},this.handleWalkPositionChange=function(){var t=82,i=36,n=0,e=0;return this._dir===DIR_E?n+=t:this._dir===DIR_W?n-=t:this._dir===DIR_SE?(n+=i,e+=i):this._dir===DIR_SW?(n-=i,e+=i):this._dir===DIR_NW?(n-=i,e-=i):this._dir===DIR_NE&&(n+=i,e-=i),this.positionPX+=n,this.positionPY+=e,this},this.equipWeapon=function(t,i){var n={action:window[t+"_EQUIP"]};if(n.callbackAnimationEnded=function(i){i._action=window[t+"_IDLE"]},t===WEAPON_SPEAR)var e=1300;else var e=1300;return this.queueAnimation(n,i,e),this},this.positionRandomly=function(){return this.positionPX=rand(0,engineView.width),this.positionPY=rand(0,engineView.height),this},this.position=function(t,i){return t||i?(this.positionPX=t,this.positionPY=i,this):{x:this.positionPX,y:this.positionPY}},this.createImageElement=function(){var t="unit-img-"+this._id,i=this._id?"id='"+t+"'":"",n="";if(this.isStaticImage())var e=this._type.substring(7),o="/img/nature/"+e+"/"+rand(1,numOfImages[e]),a=o+".png";else{var o=BASE_IMG_DIR+"all/"+this._sex+this._type+this._action+"_"+this._dir,a=o+".gif";n="unit-alive"}var r="<img "+i+" class='"+n+"' src='"+a+"' />";return{imageElement:r,imagePath:a}},this.createImageWrapper=function(){var t="unit-wrapper-"+this._id;null!==this._divSelector?this._divSelector.html("<div class='engine-unit' id='"+t+"'></div>"):($("#canvas").append("<div class='engine-unit' id='"+t+"'></div>"),this._divSelector=$("#canvas #"+t))},this.handleOptions=function(t){return t&&("undefined"!=typeof t.action&&(this._action=t.action),"undefined"!=typeof t.sex&&(this._sex=t.sex),"undefined"!=typeof t.dir&&(this._dir=t.dir),"undefined"!=typeof t.type&&(this._type=t.type)),this},this.dirTowardEast=function(){return-1!==[DIR_E,DIR_SE,DIR_NE].indexOf(this._dir)},this.dirTowardWest=function(){return-1!==[DIR_W,DIR_NW,DIR_SW].indexOf(this._dir)},this.dirTowardNorth=function(){return-1!==[DIR_NW,DIR_NE].indexOf(this._dir)},this.dirTowardSouth=function(){return-1!==[DIR_SW,DIR_SE].indexOf(this._dir)},this.isStaticImage=function(){return null!==this._type&&stringStartsWith(this._type,"nature_")},this.isActionWalk=function(){return"b"===this._action.charAt(1)},this.isActionWithWeapon=function(t){return t===WEAPON_SPEAR?weaponLetter="g":weaponLetter="a",this._action.charAt(0)===weaponLetter.charAt(0)},this.dir=function(t){return void 0===t?this._dir:void(this._dir=t)},this.action=function(t){return void 0===t?this._action:void(this._action=t)}}function gameLog(t){$(".game-log p").css("opacity","0.7"),$(".game-log").prepend("<p style='display: none' class='game-log-invisible'><span class='dot'>â€¢</span> "+t+"</p>"),$(".game-log .game-log-invisible").slideDown(700)}function gameMessage(t,i,n){"undefined"==typeof i&&(i=!0),n&&(n="color: "+n);var e=$(".game-messages");i&&e.html(""),e.prepend("<div class='game-message' style='width: "+WORLDMAP_CANVAS_WIDTH+"px;"+n+"'>"+t+"</div>")}function isDefined(t){return"undefined"!=typeof t}function isUndefined(t){return"undefined"==typeof t}function getMapCoordinatesFromScreenClick(t){var i=t.pageX-WORLDMAP_CANVAS_MARGIN_LEFT,n=t.pageY-WORLDMAP_CANVAS_MARGIN_TOP,e=-1*worldmap.css("background-position-x").slice(0,-2),o=e*zoom,a=WORLDMAP_CANVAS_WIDTH*zoom,r=i/WORLDMAP_CANVAS_WIDTH,s=-1*worldmap.css("background-position-y").slice(0,-2),m=s*zoom,d=WORLDMAP_CANVAS_HEIGHT*zoom,l=n/WORLDMAP_CANVAS_HEIGHT,_=parseInt(o+r*a),c=parseInt(m+l*d);return{mapX:_,mapY:c}}function getCanvasCoordinatesFromMapCoordinates(t,i){return{canvasX:WORLDMAP_CANVAS_MARGIN_LEFT+t/zoom-getMapOffsetPixelsX()+2,canvasY:WORLDMAP_CANVAS_MARGIN_TOP+i/zoom-getMapOffsetPixelsY()+1}}function coordinatesToString(t){return"canvasX"in t?"["+t.canvasX+","+t.canvasY+"]":"["+t.mapX+","+t.mapY+"]"}function initializeWorldmapEvents(){$(".worldmap-location").mousedown(function(t){mapMouseDown(t),t.stopPropagation()}).mouseup(function(t){mapMouseUp(t),t.stopPropagation()}).mousemove(function(t){mapMouseMove(t),t.stopPropagation()}),$(".worldmap").mousedown(function(t){mapMouseDown(t)}).mouseup(function(t){mapMouseUp(t)}).mousemove(function(t){mapMouseMove(t)}).mousewheel(function(t){mapScroll(t)}).mouseleave(function(t){mapMouseLeave(t)}).contextmenu(function(t){})}function mapMouseDown(t){worldmap=$(".worldmap"),2===t.button,mousePreviousPosition=t,mouseIsClicked=!0,mouseHasMoved=!1}function mapMouseUp(t){mouseHasMoved||mapClick(t),mouseIsClicked=!1,mousePreviousPosition=null}function mapMouseMove(t){mouseIsClicked&&(mouseHasMoved=!0),mouseIsClicked&&null!=mousePreviousPosition&&(translationVector=moveWorldmapImage(t),moveWorldmapObjects(translationVector)),mousePreviousPosition=t,gameMessage("Mouse points to "+coordinatesToString(getMapCoordinatesFromScreenClick(t)))}function mapScroll(t){var i=t.deltaY;i>=1?changeZoom(t,!1):-1>=i&&changeZoom(t,!0),mapMouseMove(t)}function mapMouseLeave(t){mouseIsClicked&&(mapMouseUp(t),mouseIsClicked=!1)}function mapClick(t){var i=getMapCoordinatesFromScreenClick(t);gameLog("<span>["+i.mapX+","+i.mapY+"]</span> is unknown wasteland, not very hospitable place.")}function initializeWorldmapLocations(){var t=$(".worldmap");recalculateWorldmapLocationVariables(),worldmapLocations.forEach(function(i,n){t.append(createHtmlFromLocationJson(i,n))})}function createHtmlFromLocationJson(t,i){var n=t._id,e=t.location.x+","+t.location.y,o=WORLDMAP_LOCATION_SIZE,a=getCanvasCoordinatesFromMapCoordinates(t.location.x,t.location.y),r="top:"+(a.canvasY-o/2)+"px;left:"+(a.canvasX-o/2)+"px;width:"+o+"px;height:"+o+"px;";return'<div class="worldmap-location" id="worldmap-location-'+n+'" variableName="worldmapLocations" variableIndex="'+i+'" style="'+r+'"><label style="margin-top:'+WORLDMAP_LOCATION_LABEL_MARGIN_TOP+'px">'+e+"</label></div>"}function recalculateWorldmapLocationVariables(){WORLDMAP_LOCATION_SIZE=WORLDMAP_LOCATION_SIZE_MODIFIER/zoom,WORLDMAP_LOCATION_LABEL_MARGIN_TOP=WORLDMAP_LOCATION_SIZE_MODIFIER/zoom*.99}function moveWorldmapImage(t){var i=t.pageX-mousePreviousPosition.pageX,n=t.pageY-mousePreviousPosition.pageY,e=worldmap.css("background-position-x"),o=worldmap.css("background-position-y");if(e=parseFloat(e.substr(0,e.length-2)),o=parseFloat(o.substr(0,o.length-2)),deltaImagePosX=i,deltaImagePosY=n,e+=deltaImagePosX,o+=deltaImagePosY,imagePosXWithScreenWidth=e-WORLDMAP_CANVAS_WIDTH,imagePosYWithScreenHeight=o-WORLDMAP_CANVAS_HEIGHT,e>0){var a=e;e=0,deltaImagePosX-=a-e}else if(imagePosXWithScreenWidth<=-WORLDMAP_WIDTH/zoom){var a=e;e=-WORLDMAP_WIDTH/zoom+WORLDMAP_CANVAS_WIDTH,deltaImagePosX-=a-e}if(o>0){var r=o;o=0,deltaImagePosY-=r-o}else if(imagePosYWithScreenHeight<=-WORLDMAP_HEIGHT/zoom){var r=o;o=-WORLDMAP_HEIGHT/zoom+WORLDMAP_CANVAS_HEIGHT,deltaImagePosY-=r-o}return setBackgroundImagePosition(e,o),updateViewRectangle(e,o),{dx:deltaImagePosX,dy:deltaImagePosY}}function moveWorldmapObjects(t){var i=getAllWorldmapObjects();console.log("==== WORLDMAP OBJECTS =====");for(var n in i){var e=i[n];console.log(e)}var o=$(".worldmap-location");$.each(o,function(i,n){var e=$("#"+n.id);e.css("top",parseFloat(e.css("top"))+t.dy),e.css("left",parseFloat(e.css("left"))+t.dx)})}function setBackgroundImagePosition(t,i){worldmap.css("background-position-x",t+"px"),worldmap.css("background-position-y",i+"px")}function WorldmapObject(t){this._id=null,this._x=null,this._y=null,this._htmlElements=[],this.constructor=function(t){this._id=__firstFreeWorldmapObjectId++;for(var i in t){var n=t[i];i="_"+i,this.fieldName=n}},this.constructor(t),this.getId=function(){return this._id},this.setCoordinates=function(t,i){return this._x=t,this._y=i,this},this.getCoordinates=function(){return{x:this._x,y:this._y}},this.addHtmlElement=function(t){return this._htmlElements.push(t),this},this.getHtmlElements=function(){return this._htmlElements.slice()}}function getAllWorldmapObjects(){return _allWorldmapObjects}function addWorldmapObject(t){var i=t.getHtmlElements();for(var n in i){var e=i[n];getWorldmap().append(e)}_allWorldmapObjects[t.getId()]=t}function WEngine_paintLine(t,i,n,e,o,a){canvasCoords=getCanvasCoordinatesFromMapCoordinates(t,i),t=canvasCoords.canvasX,i=canvasCoords.canvasY,canvasCoords=getCanvasCoordinatesFromMapCoordinates(n,e),n=canvasCoords.canvasX,e=canvasCoords.canvasY;var r=_WEngine_getLine(t,i,n,e,o);return isUndefined(a)?(a=new WorldmapObject,a.setCoordinates(t,i),a.addHtmlElement(r),addWorldmapObject(a),a):r}function WEngine_paintRectangleFromArray(t,i){return WEngine_paintRectangle(t.x,t.y,t.x+t.width,t.y+t.height,i)}function WEngine_paintRectangle(t,i,n,e,o){var a=new WorldmapObject;return a.setCoordinates(t,i),a.addHtmlElement(WEngine_paintLine(t,i,n,i,o,a)),a.addHtmlElement(WEngine_paintLine(t,e,n,e,o,a)),a.addHtmlElement(WEngine_paintLine(t,i,t,e,o,a)),a.addHtmlElement(WEngine_paintLine(n,i,n,e,o,a)),addWorldmapObject(a),a}function _WEngine_getLine(t,i,n,e,o){var a=t-n,r=i-e,s=Math.sqrt(a*a+r*r),m=(t+n)/2,d=(i+e)/2,l=m-s/2,_=d,c=Math.PI-Math.atan2(-r,a);return _WEngine_getLine_element(l,_,s,c,o)}function _WEngine_getLine_element(t,i,n,e,o){var a=document.createElement("div"),r="border: "+WENGINE_DEFAULT_LINE_WIDTH+"px dashed red; width: "+n+"px; height: 0px; -moz-transform: rotate("+e+"rad); -webkit-transform: rotate("+e+"rad); -o-transform: rotate("+e+"rad); -ms-transform: rotate("+e+"rad); position: absolute; top: "+i+"px; left: "+t+"px; ";if(isDefined(o))for(var s in o)r+=s+":"+o[s]+";";return a.setAttribute("style",r),a}function initializeWorldmapZoom(){initializeWorldmapView(),getWorldmap().css("background-size",currentWorldmapImageWidth+"px"),getWorldmap().css("background-position-x","-"+currentWorldmapView.x+"px"),getWorldmap().css("background-position-y","-"+currentWorldmapView.y+"px"),currentWorldmapImageWidth=WORLDMAP_IMAGE_INITIAL_WIDTH,currentWorldmapImageHeight=currentWorldmapImageWidth*WORLDMAP_CANVAS_WIDTH/WORLDMAP_CANVAS_HEIGHT,zoom=WORLDMAP_WIDTH/currentWorldmapImageWidth}function initializeWorldmapView(){currentWorldmapView={x:WORLDMAP_IMAGE_INITIAL_X,y:WORLDMAP_IMAGE_INITIAL_Y,width:WORLDMAP_CANVAS_WIDTH,height:WORLDMAP_CANVAS_HEIGHT}}function changeZoom(t,i){oldMapImageWidth=currentWorldmapImageWidth,oldZoom=zoom,i?currentWorldmapImageWidth-=zoomStep:currentWorldmapImageWidth+=zoomStep,zoom=WORLDMAP_WIDTH/currentWorldmapImageWidth;var n=MIN_ZOOM_VALUE>zoom,e=WORLDMAP_CANVAS_WIDTH>currentWorldmapImageWidth;if(n||e)return revertZoom();var o=currentWorldmapView.x+currentWorldmapView.width;currentWorldmapView.y+currentWorldmapView.height;console.log(o+" / "+WORLDMAP_WIDTH);var a=o>WORLDMAP_WIDTH;return a?revertZoom():($(".worldmap").css("background-size",currentWorldmapImageWidth+"px"),updateViewRectangle(),void changeZoom_updateMapLocations())}function revertZoom(){currentWorldmapImageWidth=oldMapImageWidth,zoom=oldZoom}function updateViewRectangle(t,i){if(isDefined(t)){var n,e;null!=t?(n=Math.abs(t),e=Math.abs(i)):(n=Math.abs(t.x),e=Math.abs(i.y)),currentWorldmapView.x=n,currentWorldmapView.y=e}currentWorldmapView.width=WORLDMAP_CANVAS_WIDTH/zoom,currentWorldmapView.height=WORLDMAP_CANVAS_HEIGHT/zoom}function getMapOffsetPixelsX(){return currentWorldmapView.x}function getMapOffsetPixelsY(){return currentWorldmapView.y}function changeZoom_updateMapLocations(){recalculateWorldmapLocationVariables();var t=$(".worldmap-location");$.each(t,function(t,i){var n=$("#"+i.id),e=n.attr("variableName"),o=n.attr("variableIndex"),a=window[e][o];n.css("width",WORLDMAP_LOCATION_SIZE+"px"),n.css("height",WORLDMAP_LOCATION_SIZE+"px");var r=getCanvasCoordinatesFromMapCoordinates(a.location.x,a.location.y);n.css("left",r.canvasX-WORLDMAP_LOCATION_SIZE/2),n.css("top",r.canvasY-WORLDMAP_LOCATION_SIZE/2)}),$(".worldmap-location label").css("margin-top",WORLDMAP_LOCATION_LABEL_MARGIN_TOP+"px")}function initializeWorldmap(){var t=$(".worldmap");t.css("background-image",'url("/img/map/map.jpg")')}function getWorldmap(){return null!=worldmap?worldmap:worldmap=$(".worldmap")}ACTION_IDLE="aa",ACTION_WALK="ab",ACTION_CLIMB_UP="ae",ACTION_PICK_UP="ak",ACTION_USE="al",ACTION_DODGE="an",ACTION_HIT="ao",ACTION_HIT2="ap",ACTION_HAND_COMBAT="aq",ACTION_KICK="ar",ACTION_THROW="as",ACTION_RUN="at",ACTION_RANDOM_STATIC="RANDOM_STATIC",SPEAR_IDLE="ga",SPEAR_WALK="gb",SPEAR_EQUIP="gc",SPEAR_UNEQUIP="gd",SPEAR_DODGE="ge",SPEAR_THRUST="gf",SPEAR_THROW="gm",SPEAR_RANDOM="RANDOM_SPEAR",WEAPON_SPEAR="SPEAR",WEAPON_10MM_PISTOL="10MM",DIR_W="w",DIR_E="e",DIR_NW="nw",DIR_NE="ne",DIR_SW="sw",DIR_SE="se",DIR_ALL=[DIR_W,DIR_E,DIR_NW,DIR_NE,DIR_SW,DIR_SE],WARRIOR_MALE="warr",WARRIOR_FEMALE="prim",SEX_GIRL="/img/special/sex-girl.png",NATURE_TREE="nature_tree",NATURE_GRASS="nature_grass",MALE="nm",FEMALE="nf";var BASE_IMG_DIR="/img/critter/",WALK_ANIMATION_LENGTH=800,WALK_ANIMATION_MODIFIER_WHEN_FIRST=100,allUnits=[],numOfImages=[];numOfImages.grass=5,numOfImages.misc=5,numOfImages.tree=6,__firstFreeUnitId=100;var mouseIsClicked=!1,mousePreviousPosition=null,mouseHasMoved=!1,WORLDMAP_LOCATION_SIZE_MODIFIER=35,WORLDMAP_LOCATION_SIZE=null,WORLDMAP_LOCATION_LABEL_MARGIN_TOP=null,MOUSE_DRAG_MODIFIER=1;__firstFreeWorldmapObjectId=1;var _allWorldmapObjects={};WENGINE_DEFAULT_LINE_WIDTH=2,window.initQueue.push(function(){setTimeout(function(){var t=jQuery.extend({},currentWorldmapView),i=30;t.x+=i,t.y+=i,t.width-=2*i+WENGINE_DEFAULT_LINE_WIDTH,t.height-=2*i+WENGINE_DEFAULT_LINE_WIDTH,t.width/=zoom,t.height/=zoom,WEngine_paintRectangleFromArray(t,{"background-color":"yellow"})},160)});var WORLDMAP_IMAGE_INITIAL_WIDTH=3500,WORLDMAP_IMAGE_INITIAL_X=150,WORLDMAP_IMAGE_INITIAL_Y=100,MIN_ZOOM_VALUE=.58,zoom=1,zoomStep=150,currentWorldmapView=null,currentWorldmapImageWidth=null,currentWorldmapImageHeight=null,oldMapImageWidth=null,oldZoom=null,WORLDMAP_WIDTH=3500,WORLDMAP_HEIGHT=3500;window.initQueue.push(function(){setTimeout(function(){WORLDMAP_CANVAS_WIDTH=$(".worldmap").width(),WORLDMAP_CANVAS_HEIGHT=$(".content-wrapper").height(),WORLDMAP_CANVAS_MARGIN_LEFT=$(".sidebar").width(),WORLDMAP_CANVAS_MARGIN_TOP=$(".main-header").height(),initializeWorldmap(),initializeWorldmapZoom(),initializeWorldmapLocations(),initializeWorldmapEvents()},80)});var WORLDMAP_CANVAS_WIDTH=null,WORLDMAP_CANVAS_HEIGHT=null,WORLDMAP_CANVAS_MARGIN_LEFT=null,WORLDMAP_CANVAS_MARGIN_TOP=null,worldmap=null;